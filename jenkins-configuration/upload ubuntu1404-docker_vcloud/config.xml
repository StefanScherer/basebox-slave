<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description>Upload the prebuilt OVF into production ready vCloud Catalog COM-BUILD-CATALOG.&#xd;
</description>
  <keepDependencies>false</keepDependencies>
  <properties/>
  <scm class="hudson.scm.NullSCM"/>
  <assignedNode>vmware</assignedNode>
  <canRoam>false</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers/>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.BatchFile>
      <command>set box_name=ubuntu1404-docker
set box_path=%box_name%_vcloud.box
set box_provider=vcloud

set result=0

vagrant box remove %box_name% --provider=%box_provider%
vagrant box add %box_name% c:\jenkins\workspace\%box_name%_%box_provider%\%box_path%
if ERRORLEVEL 1 set result=%ERRORLEVEL%
if ERRORLEVEL 1 goto :done

@set vcloud_hostname=roecloud001

if &quot;%VAGRANT_HOME%x&quot;==&quot;x&quot; set VAGRANT_HOME=%USERPROFILE%\.vagrant.d

@set vcloud_hostname=YOUR-VCLOUD
@set vcloud_username=YOUR-UPLOAD-USER
@set vcloud_password=S@perS$cretP1ass
@set vcloud_org=YOUR-GLOBAL-ORG
@set vcloud_catalog=YOUR-GLOBAL-CATALOG
@set vcloud_vdc=YOUR-GLOBAL-VDC

if exist c:\vagrant\resources\upload-vcloud-credentials.bat call c:\vagrant\resources\upload-vcloud-credentials.bat

echo Uploading %box_name%.ovf to vCloud %vcloud_hostname% / %vcloud_org% / %vcloud_catalog% / %box_name%
@ovftool --acceptAllEulas --vCloudTemplate --overwrite %VAGRANT_HOME%\boxes\%box_name%\0\%box_provider%\%box_name%.ovf &quot;vcloud://%vcloud_username%:%vcloud_password%@%vcloud_hostname%:443?org=%vcloud_org%&amp;vappTemplate=%box_name%&amp;catalog=%vcloud_catalog%&amp;vdc=%vcloud_vdc%&quot;
if ERRORLEVEL 1 goto :first_upload
goto :uploaded
:first_upload
@ovftool --acceptAllEulas --vCloudTemplate %VAGRANT_HOME%\boxes\%box_name%\0\%box_provider%\%box_name%.ovf &quot;vcloud://%vcloud_username%:%vcloud_password%@%vcloud_hostname%:443?org=%vcloud_org%&amp;vappTemplate=%box_name%&amp;catalog=%vcloud_catalog%&amp;vdc=%vcloud_vdc%&quot;
if ERRORLEVEL 1 goto :error_vcloud_upload
:uploaded
vagrant box remove %box_name% --provider=%box_provider%
if ERRORLEVEL 1 set result=%ERRORLEVEL%

:error_vcloud_upload
echo Error Uploading box to vCloud with ovftool!
set result=%ERRORLEVEL%
goto :done

:done
exit %result%
</command>
    </hudson.tasks.BatchFile>
  </builders>
  <publishers>
    <hudson.tasks.Mailer plugin="mailer@1.8">
      <recipients>scherer_stefan@icloud.com</recipients>
      <dontNotifyEveryUnstableBuild>false</dontNotifyEveryUnstableBuild>
      <sendToIndividuals>false</sendToIndividuals>
    </hudson.tasks.Mailer>
  </publishers>
  <buildWrappers/>
</project>